<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1" />
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <meta name="theme-color" content="#f9f9f9" />
    <title>WebStack-Hugo 网址导航</title>
    <link rel="shortcut icon" href="/assets/images/favicon.png" />
    <meta name="keywords" content="WebStack-Hugo 网址导航" />
    
    <meta name="baidu-site-verification" content="codeva-cCAOSG8MBO" />
    
    <link rel="stylesheet" id="block-library-css"
        href="/assets/css/block-library.min-5.6.2.css" type="text/css" media="all" />
    <link rel="stylesheet" id="iconfont-css" href="/assets/css/iconfont-3.03029.1.css"
        type="text/css" media="all" />
    <link rel="stylesheet" id="bootstrap-css" href="/assets/css/bootstrap.min-4.3.1.css"
        type="text/css" media="all" />
    <link rel="stylesheet" id="fancybox-css" href="/assets/css/fancybox.min-3.5.7.css"
        type="text/css" media="all" />
    <link rel="stylesheet" id="iowen-css" href="/assets/css/style-3.03029.1.css"
        type="text/css" media="all" />
    <link rel="stylesheet" id="custom-css" href="/assets/css/custom-style.css"
        type="text/css" media="all" />
    <link rel="stylesheet" id="fortawesome-css" href="/assets/fontawesome-5.15.4/css/all.min.css" type="text/css" />
    <script type="text/javascript" src="/assets/js/jquery.min-3.2.1.js" id="jquery-js"></script>
    <script type="text/javascript" src="/assets/js/content-search.js"  id="content-search-js"></script>
    
    <script>
        
        var _hmt = _hmt || [];
            (function () {
                var hm = document.createElement("script");
                hm.src = "https://hm.baidu.com/hm.js?efccc04cb44fc49faddac5876180b369";
                var s = document.getElementsByTagName("script")[0];
                s.parentNode.insertBefore(hm, s);
            })();
        
    </script>
    
    
     
    
    
    
    
</head>


<div class="main-content flex-fill grid-bg">
    <div class="big-header-banner">
        <div id="header" class="page-header sticky">
            <div class="navbar navbar-expand-md">
                <div class="container-fluid p-0">

                    <a href="" class="navbar-brand d-md-none" title="WebStack-Hugo 网址导航">
                        <img src="/assets/images/bt.png" class="logo-light"
                            alt="WebStack-Hugo 网址导航">
                        <img src="/assets/images/bt.png" class="logo-dark d-none"
                            alt="WebStack-Hugo 网址导航">
                    </a>

                    <div class="collapse navbar-collapse order-2 order-md-1">
                        <div class="header-mini-btn">
                            <label>
                                <input id="mini-button" type="checkbox">
                                <svg viewbox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                                    <path class="line--1" d="M0 40h62c18 0 18-20-17 5L31 55"></path>
                                    <path class="line--2" d="M0 50h80"></path>
                                    <path class="line--3" d="M0 60h62c18 0 18 20-17-5L31 45"></path>
                                </svg>
                            </label>

                        </div>

                        <ul class="navbar-nav site-menu" style="margin-right: 16px;">
                        
			<li >
				<a href="./">
                                    <i class="fa fa-home fa-lg mr-2"></i>
                                    <span>首页</span>
                                </a>
				<ul class="sub-menu">
				
				</ul>
			    </li>
			
			<li >
				<a href="https://www.jackssybin.cn/">
                                    <i class="fa fa-book fa-lg mr-2"></i>
                                    <span>作者</span>
                                </a>
				<ul class="sub-menu">
				
				</ul>
			    </li>
			
			<li class="menu-item-has-children">
				<a href="">
                                    <i class="fa fa-cog fa-lg mr-2"></i>
                                    <span>配置</span>
                                </a>
				<ul class="sub-menu">
				
				    <li><a href="#">源码</a></li>
				
				    <li><a href="#">图标</a></li>
				
				</ul>
			    </li>
			
			</ul>

                        
                        <div class="rounded-circle weather">
                            <div id="he-plugin-simple" style="display: contents;"></div>
                            <script>WIDGET = {
                                    CONFIG: {
                                        "modules": "01234",
                                        "background": 5,
                                        "tmpColor": "E4C600",
                                        "tmpSize": 14,
                                        "cityColor": "E4C600",
                                        "citySize": 14,
                                        "aqiColor": "#E4C600",
                                        "aqiSize": 14,
                                        "weatherIconSize": 24,
                                        "alertIconSize": 18,
                                        "padding": "10px 10px 10px 10px",
                                        "shadow": "1",
                                        "language": "auto",
                                        "borderRadius": 5,
                                        "fixed": "false",
                                        "vertical": "middle",
                                        "horizontal": "left",
                                        "key": "085791e805a24491b43b06cf58ab31e7"
                                    }
                                }
                            </script>
                            <script src="https://widget.qweather.net/simple/static/js/he-simple-common.js?v=2.0"></script>
                        </div>
                        
                    </div>

                    <ul class="nav navbar-menu text-xs order-1 order-md-2">
                        
                        
                        <li class="nav-item mr-3 mr-lg-0 d-none d-lg-block">
                            <script>
                                fetch('https://v1.hitokoto.cn')
                                    .then(response => response.json())
                                    .then(data => {
                                    const hitokoto = document.getElementById('hitokoto_text')
                                    hitokoto.href = 'https://hitokoto.cn/?uuid=' + data.uuid
                                    hitokoto.innerText = data.hitokoto
                                    })
                                    .catch(console.error)
                            </script>                           
                            <div id="hitokoto"><a href="#" target="_blank" id="hitokoto_text">疏影横斜水清浅，暗香浮动月黄昏。</a></div>
                        </li>
                        
                        
                        <li class="nav-search ml-3 ml-md-4">
                            <a href="javascript:" data-toggle="modal" data-target="#search-modal"><i
                                    class="iconfont icon-search icon-2x"></i></a>
                        </li>
                        <li class="nav-item d-md-none mobile-menu ml-3 ml-md-4">
                            <a href="javascript:" id="sidebar-switch" data-toggle="modal"
                                data-target="#sidebar"><i class="iconfont icon-classification icon-2x"></i></a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="placeholder" style="height:74px"></div>
    </div>


<body class="page-body boxed-container">
    <main role="main" class="flex-shrink-0">
    <div class="container">
        <h1 class="mt-5"></h1>
        <div class="content">
            <h2 id="permalink-articles201909201568913777036html">title: 来来scrapy爬取各大网站每日热点新闻
date: &lsquo;2019-09-20 01:22:57&rsquo;
updated: &lsquo;2019-09-22 00:33:49&rsquo;
tags: [数据库, scrapy, python实战, python学习]
permalink: /articles/2019/09/20/1568913777036.html</h2>
<h2 id="一背景">一.背景</h2>
<p>最近玩爬虫，各种想爬，scrapy又非常好用。想多爬一点东西，决定爬一爬各大网站的热点新闻。
想到就开始做了哈
项目已经爬取：
<a href="https://www.douban.com/gallery/">豆瓣</a>，     <a href="https://s.weibo.com/top/summary">微博</a>， <a href="http://tieba.baidu.com/hottopic/browse/topicList?res_type=1&amp;red_tag=h1923737578">百度贴吧</a>， <a href="https://bbs.hupu.com/all-gambia">虎扑</a>，  <a href="https://github.com/trending">github</a>，<a href="http://top.baidu.com/buzz?b=341&amp;c=513&amp;fr=topbuzz_b1_c513">百度今日热点</a></p>
<h2 id="二上代码">二.上代码</h2>
<h5 id="1开始搭建项目">1.开始搭建项目</h5>
<pre tabindex="0"><code>scrapy startproject crawl_everything  
#起了个叼叼的名字
</code></pre><h5 id="2修改配置文件">2.修改配置文件</h5>
<ul>
<li>settings.py设置文件:</li>
</ul>
<pre tabindex="0"><code>ROBOTSTXT_OBEY = False
# 下载延时
DOWNLOAD_DELAY = 0.5
<p>#增加user-agent 这个可以拿自己浏览器的。也可以网上搜一些其他的。东西很多的
USER_AGENT = 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_8_3) AppleWebKit/536.5 (KHTML, like Gecko) Chrome/19.0.1084.54 Safari/536.5'
</code></pre><p>初步设想，我只需要存取文章的标题和内容链接和抓取时间</p></p>
<ul>
<li>修改items.py
那么定义的item如下：</li>
</ul>
<pre tabindex="0"><code>class CrawlEverythingItem(scrapy.Item):
    # 文章标题
    jk_title = scrapy.Field()
    # 文章链接
    jk_url = scrapy.Field()
    # 文章时间有可能没有
    jk_date = scrapy.Field()
</code></pre><h5 id="3--生成第一个网站文件豆瓣">3 : 生成第一个网站文件【豆瓣】:</h5>
<p>#注意:这个命令在spiders目录执行</p>
<pre tabindex="0"><code>scrapy genspider douban_spider www.douban.com
</code></pre><p>上个结果图：
<img src="https://img.hacpai.com/file/2019/09/1-be122b0d.png" alt="1.png"></p>
<p>#先抓取豆瓣上的【24小时话题趋势】看看大家都在讨论啥
目标网址:<a href="https://www.douban.com/gallery/">https://www.douban.com/gallery/</a>
<img src="https://img.hacpai.com/file/2019/09/2-33b49367.png" alt="2.png"></p>
<p>知道目标了就开始爬吧：通过chrome的debug功能找到对应标签</p>
<pre tabindex="0"><code> def parse(self, response):
        trends=response.css(&#39;ul.trend &gt; li &gt; a&#39;)
        for trend in trends:
            item = CrawlEverythingItem()
            item[&#39;jk_title&#39;]=trend.css(&#39;a::text&#39;).extract_first()
            item[&#39;jk_url&#39;] = trend.css(&#39;a&#39;).attrib[&#39;href&#39;]
            yield item
</code></pre><p>程序这就写好了。运行一下</p>
<pre tabindex="0"><code>scrapy crawl douban_spider
</code></pre><p><img src="https://img.hacpai.com/file/2019/09/3-cee4064f.png" alt="3.png">
可以看到确实是能把文章给爬到。
但每次需要输入命令颇为麻烦。
为了简单弄了个main函数主程序【mainCrawlEveryThing.py】，方便启动和debug
内容如下：</p>
<pre tabindex="0"><code># coding: utf-8
from scrapy.cmdline import execute
import sys
import os
<p>sys.path.append(os.path.dirname(os.path.abspath(<strong>file</strong>)))
execute(['scrapy', 'crawl', 'douban_spider'])  # 你需要将此处的douban_spider替换为你自己的爬虫名称
</code></pre><p>运行程序，效果和在cmd里输入命令效果一致。</p></p>
<h5 id="4--数据入库">4 : 数据入库:</h5>
<p>接下来数据爬到了该入库了。
新建了一个数据库和一张表</p>
<pre tabindex="0"><code>create database crawl_everything;
<p>drop TABLE <code>article_info</code>;
CREATE TABLE <code>article_info</code> (
<code>article_id</code> bigint(20) NOT NULL AUTO_INCREMENT COMMENT '文章id',
<code>jk_source</code> varchar(50) DEFAULT NULL COMMENT '文章来源',
<code>jk_title</code> varchar(200) DEFAULT NULL COMMENT '文章标题',
<code>jk_url</code> varchar(200) DEFAULT NULL COMMENT '文章url',
<code>jk_status</code> varchar(50) DEFAULT '0' COMMENT '状态 0:禁用，1:正常',
<code>jk_remark</code> varchar(500) DEFAULT NULL COMMENT '备注',
<code>jk_create</code> datetime DEFAULT NULL COMMENT '创建时间',
PRIMARY KEY (<code>article_id</code>)
) ENGINE=InnoDB AUTO_INCREMENT=12 DEFAULT CHARSET=utf8 COMMENT='文章相关';
</code></pre><p>修改配置文件settings.py</p></p>
<pre tabindex="0"><code>ITEM_PIPELINES = {
   &#39;crawl_everything.pipelines.CrawlEverythingPipeline&#39;: 400
}
</code></pre><p>修改配置文件pipelines.py
<p>然后保存数据更改一下</p></p>
<pre tabindex="0"><code>import  pymysql
import datetime;
import sys;
reload(sys);
sys.setdefaultencoding(&#34;utf8&#34;)

class CrawlEverythingPipeline(object):
    def __init__(self):
        # 连接MySQL数据库
        self.connect = pymysql.connect(host=&#39;localhost&#39;, user=&#39;root&#39;, password=&#39;root1234&#39;, db=&#39;crawl_everything&#39;, port=3307)
        self.cursor = self.connect.cursor()

    def process_item(self, item, spider):
        # 往数据库里面写入数据
        self.cursor.execute(
            &#39;INSERT INTO crawl_everything.article_info( jk_source, jk_title, jk_url, jk_remark, jk_create) &#39;
            &#39;VALUES(&#34;{}&#34;,&#34;{}&#34;,&#34;{}&#34;,&#34;{}&#34;,&#34;{}&#34;)&#39;.format(item[&#39;jk_source&#39;], item[&#39;jk_title&#39;],item[&#39;jk_url&#39;],item[&#39;jk_remark&#39;],datetime.datetime.now().strftime(&#34;%Y-%m-%d %H:%M:%S&#34;))
        )
        self.connect.commit()
        return item
        # 关闭数据库

    def close_spider(self, spider):
        self.cursor.close()
        self.connect.close()
</code></pre><p>再次重新运行主函数，爬取到的数据已经入库
<p><img src="https://img.hacpai.com/file/2019/09/4-986667d6.png" alt="4.png"></p></p>
<p>后续在完善:先开门红一个豆瓣。逐步完善
用一个爬虫主类增加了几个网站的爬取，</p>
<pre tabindex="0"><code> def parse(self, response):
        if response.url == self.start_urls[0]:#豆瓣
            yield from self.crawl_douban(response)
        if response.url == self.start_urls[1]:  # 微博
            yield from self.crawl_weibo(response)
        if response.url == self.start_urls[2]:  # 百度贴吧
            yield from self.crawl_tieba(response)
        if response.url == self.start_urls[3]:  # 虎扑
            yield from self.crawl_hupu(response)
        if response.url == self.start_urls[4]:  # github
            yield from self.crawl_github(response)
        if response.url == self.start_urls[5]:  # 百度今日热点
            yield from self.crawl_topbaidu(response)
    def crawl_douban(self, response):
        trends = response.css(&#39;ul.trend &gt; li &gt; a&#39;)
        for trend in trends:
            item = CrawlEverythingItem()
            item[&#39;jk_source&#39;] = &#39;douban_spider&#39;
            item[&#39;jk_title&#39;] = trend.css(&#39;a::text&#39;).extract_first()
            item[&#39;jk_url&#39;] = trend.css(&#39;a&#39;).attrib[&#39;href&#39;]
            item[&#39;jk_remark&#39;] = &#39;&#39;
            yield item
<pre><code>def crawl_weibo(self, response):
    trends = response.css(&amp;#39;td.td-02 &amp;gt; a&amp;#39;)
    for trend in trends:
        item = CrawlEverythingItem()
        item[&amp;#39;jk_source&amp;#39;] = &amp;#39;weibo_spider&amp;#39;
        item[&amp;#39;jk_title&amp;#39;] = trend.css(&amp;#39;a::text&amp;#39;).extract_first()
        href = self.get_weibo_href(trend)
        item[&amp;#39;jk_url&amp;#39;] = &amp;#34;https://s.weibo.com&amp;#34; + href
        item[&amp;#39;jk_remark&amp;#39;] = &amp;#39;&amp;#39;
        yield item

def crawl_tieba(self, response):
    trends = response.css(&amp;#39;div.main &amp;gt; ul &amp;gt; li  a&amp;#39;)
    for trend in trends:
        item = CrawlEverythingItem()
        item[&amp;#39;jk_source&amp;#39;] = &amp;#39;tieba_spider&amp;#39;
        item[&amp;#39;jk_title&amp;#39;] = trend.css(&amp;#39;a::text&amp;#39;).extract_first()
        item[&amp;#39;jk_url&amp;#39;] = trend.css(&amp;#39;a&amp;#39;).attrib[&amp;#39;href&amp;#39;]
        item[&amp;#39;jk_remark&amp;#39;] = &amp;#39;&amp;#39;
        yield item

def crawl_hupu(self, response):
    trends = response.css(&amp;#39;div.list&amp;gt; ul &amp;gt; li &amp;gt;span:nth-child(1) &amp;gt;a&amp;#39;)
    for trend in trends:
        item = CrawlEverythingItem()
        item[&amp;#39;jk_source&amp;#39;] = &amp;#39;hupu_spider&amp;#39;
        item[&amp;#39;jk_title&amp;#39;] = trend.css(&amp;#39;a&amp;#39;).attrib[&amp;#39;title&amp;#39;]
        item[&amp;#39;jk_url&amp;#39;] =&amp;#34;https://bbs.hupu.com&amp;#34;+trend.css(&amp;#39;a&amp;#39;).attrib[&amp;#39;href&amp;#39;]
        item[&amp;#39;jk_remark&amp;#39;] = &amp;#39;&amp;#39;
        yield item

def crawl_github(self, response):
    trends = response.css(&amp;#39;div&amp;gt; article.Box-row &amp;#39;)
    for trend in trends:
        item = CrawlEverythingItem()
        item[&amp;#39;jk_source&amp;#39;] = &amp;#39;github_spider&amp;#39;
        jk_title=&amp;#34;&amp;#34;.join(trend.css(&amp;#39;p::text&amp;#39;).extract())
        re.sub(r&amp;#39;[\\*|“&amp;lt;&amp;gt;:/()（）0123456789]&amp;#39;, &amp;#39;&amp;#39;, jk_title)
        jk_title.replace(&amp;#39;\n&amp;#39;, &amp;#39;&amp;#39;).replace(&amp;#39;  &amp;#39;, &amp;#39;&amp;#39;)
        item[&amp;#39;jk_title&amp;#39;] = jk_title
        item[&amp;#39;jk_url&amp;#39;] = &amp;#34;https://github.com&amp;#34; + trend.css(&amp;#39;h1&amp;gt;a&amp;#39;).attrib[&amp;#39;href&amp;#39;]
        item[&amp;#39;jk_remark&amp;#39;] = &amp;#39;&amp;#39;
        yield item

def crawl_topbaidu(self, response):
    trends = response.css(&amp;#39;td.keyword &amp;gt;a:nth-child(1) &amp;#39;)
    for trend in trends:
        item = CrawlEverythingItem()
        item[&amp;#39;jk_source&amp;#39;] = &amp;#39;topbaidu_spider&amp;#39;
        item[&amp;#39;jk_title&amp;#39;] = trend.css(&amp;#39;a::text&amp;#39;).extract_first()
        item[&amp;#39;jk_url&amp;#39;] = trend.css(&amp;#39;a&amp;#39;).attrib[&amp;#39;href&amp;#39;]
        item[&amp;#39;jk_remark&amp;#39;] = &amp;#39;&amp;#39;
        yield item

def get_weibo_href(self,trend):
    href = trend.css(&amp;#39;a&amp;#39;).attrib[&amp;#39;href&amp;#39;]
    if href.startswith(&amp;#39;javascript&amp;#39;):  ##javascript:void(0)
        href = trend.css(&amp;#39;a&amp;#39;).attrib[&amp;#39;href_to&amp;#39;]
    return href
</code></pre>
<p></code></pre><p>增加了一个爬虫主类mainCrawlEveryThing.py</p></p>
<pre tabindex="0"><code># coding: utf-8
from scrapy.cmdline import execute
import sys
import os
sys.path.append(os.path.dirname(os.path.abspath(__file__)))

execute([&#39;scrapy&#39;, &#39;crawl&#39;, &#39;crawl_everything_spider&#39;])  # 你需要将此处的douban_spider替换为你自己的爬虫名称
</code></pre><p>数据库增加一个日期字段，修改了创建时间字段。
<p>git已修改，并上传。</p></p>
<p>git已上传：<a href="https://github.com/jackssybin/crawl_everything">https://github.com/jackssybin/crawl_everything</a></p>

        </div>
    </div>
    </main>

    <style>
        .content {
            font-size: 1.25rem;
          }
          
          .content h1,
          .content h2,
          .content h3,
          .content h4 {
            margin: 15px 10px 5px;
          }
          
    </style>

        <footer class="main-footer footer-type-1 text-xs">
            <div id="footer-tools" class="d-flex flex-column">
                <a href="javascript:" id="go-to-up" class="btn rounded-circle go-up m-1" rel="go-top">
                    <i class="iconfont icon-to-up"></i>
                </a>
                
                <a href="javascript:" data-toggle="modal" data-target="#search-modal" class="btn rounded-circle m-1"
                    rel="search" one-link-mark="yes">
                    <i class="iconfont icon-search"></i>
                </a>
                <a href="https://www.yuque.com/shenweiyan" class="btn rounded-circle kefu m-1" target="_blank" data-toggle="tooltip" data-placement="left" title="联系我们">
                    <i class="mode-ico iconfont icon-qq"></i>
                </a>
                
                
		<a href="javascript:" onclick="window.location.href='javascript:switchNightMode()'" class="btn rounded-circle switch-dark-mode m-1" id="yejian"
                    data-toggle="tooltip" data-placement="left" title="日间模式">
                    <i class="mode-ico iconfont icon-night"></i>
                </a>
                
            </div>
            <div class="footer-inner">
                <div class="footer-text">本站内容源自互联网，如有内容侵犯了你的权益，请联系删除相关内容，联系邮箱：jackxiazhou@yeah.net <br/>© 2023 - 2024 By <a href="https://github.com/shenweiyan/WebStack-Hugo">WebStack-Hugo</a> | <a href="https://www.bioitee.com/">Bio IT 爱好者</a> | <a href="http://beian.miit.gov.cn/">京ICP备17039180号-1</a><br/></div>
            </div>
        </footer>
    </div>
</div>


<script type='text/javascript' src='/assets/js/jquery.ui.touch-punch.min-0.2.2.js' id='jqueryui-touch-js'></script>
<script type='text/javascript' src='/assets/js/clipboard.min-5.6.2.js' id='clipboard-js'></script>
<script type='text/javascript' src='/assets/js/tooltip-extend.js' id='iplaycode-nav-js'></script>
<script type='text/javascript' id='popper-js-extra'>
 

var theme = {"ajaxurl":"","addico":"https:\/\/nav.baidu.cn\/wp-content\/themes\/onenav\/images\/add.png","order":"asc","formpostion":"top","defaultclass":"io-grey-mode","isCustomize":"1","icourl":"","icopng":".png","urlformat":"1","customizemax":"10","newWindow":"0","lazyload":"1","minNav":"1","loading":"1","hotWords":"baidu","classColumns":" col-sm-6 col-md-4 col-xl-5a col-xxl-6a ","apikey":"TWpBeU1UVTNOekk1TWpVMEIvZ1M2bFVIQllUMmxsV1dZelkxQTVPVzB3UW04eldGQmxhM3BNWW14bVNtWk4="};
 
</script>
<script type='text/javascript' src='/assets/js/popper.min.js' id='popper-js'></script>
<script type='text/javascript' src='/assets/js/bootstrap.min-4.3.1.js' id='bootstrap-js'></script>
<script type='text/javascript' src='/assets/js/theia-sticky-sidebar-1.5.0.js' id='sidebar-js'></script>
<script type='text/javascript' src='/assets/js/lazyload.min-12.4.0.js' id='lazyload-js'></script>
<script type='text/javascript' src='/assets/js/fancybox.min-3.5.7.js' id='lightbox-js-js'></script>

<script type='text/javascript' src='/assets/js/app-mini.js' id='appmini-js'></script>

<script type="text/javascript">
    $(document).ready(function(){
        var siteWelcome = $('#loading');
        siteWelcome.addClass('close');
        setTimeout(function() {
            siteWelcome.remove();
        }, 600);
    });
</script>
<script>        
    $(document).ready(function(){
        setTimeout(function () {
            if ($('a.smooth[href="' + window.location.hash + '"]')[0]) {
                $('a.smooth[href="' + window.location.hash + '"]').click();
            }else if (window.location.hash != '') {
                $("html, body").animate({
                    scrollTop: $(window.location.hash).offset().top - 90
                }, {
                    duration: 500,
                    easing: "swing"
                });
            }
        }, 300);
        $(document).on('click','a.smooth',function(ev) {
            if($('#sidebar').hasClass('show') && !$(this).hasClass('change-href')){
                $('#sidebar').modal('toggle');
            }
            if($(this).attr("href").substr(0, 1) == "#"){
                $("html, body").animate({
                    scrollTop: $($(this).attr("href")).offset().top - 90
                }, {
                    duration: 500,
                    easing: "swing"
                });
            }
            if($(this).hasClass('go-search-btn')){
                $('#search-text').focus();
            }
            if(!$(this).hasClass('change-href')){
                var menu =  $("a"+$(this).attr("href"));
                menu.click();
                toTarget(menu.parent().parent(),true,true);
            }
        });
        $(document).on('click','a.tab-noajax',function(ev) {
            var url = $(this).data('link');
            if(url)
                $(this).parents('.d-flex.flex-fill.flex-tab').children('.btn-move.tab-move').show().attr('href', url);
            else
                $(this).parents('.d-flex.flex-fill.flex-tab').children('.btn-move.tab-move').hide();
        });
        
    });
</script>

<script>

(function(){
    if(document.cookie.replace(/(?:(?:^|.*;\s*)night\s*\=\s*([^;]*).*$)|^.*$/, "$1") === ''){
        if(new Date().getHours() > 22 || new Date().getHours() < 6){
            document.body.classList.remove('io-black-mode');
            document.body.classList.add('io-grey-mode');
            document.cookie = "night=1;path=/";
            console.log('夜间模式开启');
        }else{
            document.body.classList.remove('night');
            document.cookie = "night=0;path=/";
            console.log('夜间模式关闭');
        }
    }else{
        var night = document.cookie.replace(/(?:(?:^|.*;\s*)night\s*\=\s*([^;]*).*$)|^.*$/, "$1") || '0';
        if(night == '0'){
            document.body.classList.remove('night');
        }else if(night == '1'){
            document.body.classList.add('night');
        }
    }
})();

$("#search-bg").css("background-image", "url(assets\/images\/bg-dna.jpg)");   
function switchNightMode(){
    var night = document.cookie.replace(/(?:(?:^|.*;\s*)night\s*\=\s*([^;]*).*$)|^.*$/, "$1") || '0';
    if(night == '0'){
	$("#search-bg").css("background-image", "url(assets\/images\/bg-dna.jpg)");
        document.body.classList.remove('io-grey-mode');
        document.body.classList.add('io-black-mode');
        document.cookie = "night=1;path=/"
        console.log(' ');
        $(".switch-dark-mode").attr("data-original-title","日间模式");
        $(".mode-ico").removeClass("icon-night");
        $(".mode-ico").addClass("icon-light");
    }else{
	$("#search-bg").css("background-image", "url(assets\/images\/bg-dna.jpg)")
        document.body.classList.remove('io-black-mode');
        document.body.classList.add('io-grey-mode');
        document.cookie = "night=0;path=/"
        console.log(' ');
        $(".switch-dark-mode").attr("data-original-title","夜间模式");
        $(".mode-ico").removeClass("icon-light");
        $(".mode-ico").addClass("icon-night");
    }
}
</script>
</body>
</html>

