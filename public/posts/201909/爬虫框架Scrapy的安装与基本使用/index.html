<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1" />
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <meta name="theme-color" content="#f9f9f9" />
    <title>jackssybin网址导航</title>
    <link rel="shortcut icon" href="/assets/images/favicon.png" />
    <meta name="keywords" content="jackssybin网址导航" />
    
    <meta name="baidu-site-verification" content="codeva-cCAOSG8MBO" />
    
    <link rel="stylesheet" id="block-library-css"
        href="/assets/css/block-library.min-5.6.2.css" type="text/css" media="all" />
    <link rel="stylesheet" id="iconfont-css" href="/assets/css/iconfont-3.03029.1.css"
        type="text/css" media="all" />
    <link rel="stylesheet" id="bootstrap-css" href="/assets/css/bootstrap.min-4.3.1.css"
        type="text/css" media="all" />
    <link rel="stylesheet" id="fancybox-css" href="/assets/css/fancybox.min-3.5.7.css"
        type="text/css" media="all" />
    <link rel="stylesheet" id="iowen-css" href="/assets/css/style-3.03029.1.css"
        type="text/css" media="all" />
    <link rel="stylesheet" id="custom-css" href="/assets/css/custom-style.css"
        type="text/css" media="all" />
    <link rel="stylesheet" id="fortawesome-css" href="/assets/fontawesome-5.15.4/css/all.min.css" type="text/css" />
    <script type="text/javascript" src="/assets/js/jquery.min-3.2.1.js" id="jquery-js"></script>
    <script type="text/javascript" src="/assets/js/content-search.js"  id="content-search-js"></script>
    
    <script>
        
        var _hmt = _hmt || [];
            (function () {
                var hm = document.createElement("script");
                hm.src = "https://hm.baidu.com/hm.js?efccc04cb44fc49faddac5876180b369";
                var s = document.getElementsByTagName("script")[0];
                s.parentNode.insertBefore(hm, s);
            })();
        
    </script>
    
    
     
    
    
    
    
</head>


<div class="main-content flex-fill grid-bg">
    <div class="big-header-banner">
        <div id="header" class="page-header sticky">
            <div class="navbar navbar-expand-md">
                <div class="container-fluid p-0">

                    <a href="" class="navbar-brand d-md-none" title="jackssybin网址导航">
                        <img src="/assets/images/bt.png" class="logo-light"
                            alt="jackssybin网址导航">
                        <img src="/assets/images/bt.png" class="logo-dark d-none"
                            alt="jackssybin网址导航">
                    </a>

                    <div class="collapse navbar-collapse order-2 order-md-1">
                        <div class="header-mini-btn">
                            <label>
                                <input id="mini-button" type="checkbox">
                                <svg viewbox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                                    <path class="line--1" d="M0 40h62c18 0 18-20-17 5L31 55"></path>
                                    <path class="line--2" d="M0 50h80"></path>
                                    <path class="line--3" d="M0 60h62c18 0 18 20-17-5L31 45"></path>
                                </svg>
                            </label>

                        </div>

                        <ul class="navbar-nav site-menu" style="margin-right: 16px;">
                        
			<li >
				<a href="./">
                                    <i class="fa fa-home fa-lg mr-2"></i>
                                    <span>首页</span>
                                </a>
				<ul class="sub-menu">
				
				</ul>
			    </li>
			
			<li >
				<a href="https://www.jackssybin.cn/">
                                    <i class="fa fa-book fa-lg mr-2"></i>
                                    <span>作者</span>
                                </a>
				<ul class="sub-menu">
				
				</ul>
			    </li>
			
			<li class="menu-item-has-children">
				<a href="">
                                    <i class="fa fa-cog fa-lg mr-2"></i>
                                    <span>配置</span>
                                </a>
				<ul class="sub-menu">
				
				    <li><a href="#">源码</a></li>
				
				    <li><a href="#">图标</a></li>
				
				</ul>
			    </li>
			
			</ul>

                        
                        <div class="rounded-circle weather">
                            <div id="he-plugin-simple" style="display: contents;"></div>
                            <script>WIDGET = {
                                    CONFIG: {
                                        "modules": "01234",
                                        "background": 5,
                                        "tmpColor": "E4C600",
                                        "tmpSize": 14,
                                        "cityColor": "E4C600",
                                        "citySize": 14,
                                        "aqiColor": "#E4C600",
                                        "aqiSize": 14,
                                        "weatherIconSize": 24,
                                        "alertIconSize": 18,
                                        "padding": "10px 10px 10px 10px",
                                        "shadow": "1",
                                        "language": "auto",
                                        "borderRadius": 5,
                                        "fixed": "false",
                                        "vertical": "middle",
                                        "horizontal": "left",
                                        "key": "085791e805a24491b43b06cf58ab31e7"
                                    }
                                }
                            </script>
                            <script src="https://widget.qweather.net/simple/static/js/he-simple-common.js?v=2.0"></script>
                        </div>
                        
                    </div>

                    <ul class="nav navbar-menu text-xs order-1 order-md-2">
                        
                        
                        <li class="nav-item mr-3 mr-lg-0 d-none d-lg-block">
                            <script>
                                fetch('https://v1.hitokoto.cn')
                                    .then(response => response.json())
                                    .then(data => {
                                    const hitokoto = document.getElementById('hitokoto_text')
                                    hitokoto.href = 'https://hitokoto.cn/?uuid=' + data.uuid
                                    hitokoto.innerText = data.hitokoto
                                    })
                                    .catch(console.error)
                            </script>                           
                            <div id="hitokoto"><a href="#" target="_blank" id="hitokoto_text">疏影横斜水清浅，暗香浮动月黄昏。</a></div>
                        </li>
                        
                        
                        <li class="nav-search ml-3 ml-md-4">
                            <a href="javascript:" data-toggle="modal" data-target="#search-modal"><i
                                    class="iconfont icon-search icon-2x"></i></a>
                        </li>
                        <li class="nav-item d-md-none mobile-menu ml-3 ml-md-4">
                            <a href="javascript:" id="sidebar-switch" data-toggle="modal"
                                data-target="#sidebar"><i class="iconfont icon-classification icon-2x"></i></a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="placeholder" style="height:74px"></div>
    </div>


<body class="page-body boxed-container">
    <main role="main" class="flex-shrink-0">
    <div class="container">
        <h1 class="mt-5"></h1>
        <div class="content">
            <h2 id="permalink-articles201909161568641811471html">title: 爬虫框架Scrapy的安装与基本使用
date: &lsquo;2019-09-01 21:53:19&rsquo;
updated: &lsquo;2019-09-01 21:53:19&rsquo;
tags: [scrapy, python学习]
permalink: /articles/2019/09/16/1568641811471.html</h2>
<p><strong>一、简单实例，了解基本。</strong>
1、安装Scrapy框架</p>
<p>这里如果直接pip3 install scrapy可能会出错。</p>
<p>所以你可以先安装lxml：pip3 install lxml(已安装请忽略)。</p>
<p>安装pyOpenSSL：在官网下载wheel文件。</p>
<p>安装Twisted：在官网下载wheel文件。</p>
<p>安装PyWin32：在官网下载wheel文件。</p>
<p>下载地址：https://www.lfd.uci.edu/~gohlke/pythonlibs/</p>
<p>配置环境变量：将scrapy所在目录添加到系统环境变量即可。</p>
<p>ctrl+f搜索即可。</p>
<p>最后安装scrapy，pip3 install scrapy</p>
<p>2、创建一个scrapy项目</p>
<p>新创建一个目录，按住shift-右键-在此处打开命令窗口</p>
<p>输入：scrapy startproject tutorial即可创建一个tutorial文件夹</p>
<p>文件夹目录如下：</p>
<pre tabindex="0"><code>|-tutorial
<p>|-scrapy.cfg</p>
<p>  |-<strong>init</strong>.py</p>
<p>  |-items.py</p>
<p>  |-middlewares.py</p>
<p>  |-pipelines.py</p>
<p>  |-settings.py</p>
<p>  |-spiders</p>
<p>    |-<strong>init</strong>.py~~~~
</code></pre><p>文件的功能：</p></p>
<p>scrapy.cfg：配置文件</p>
<p>spiders：存放你Spider文件，也就是你爬取的py文件</p>
<p>items.py：相当于一个容器，和字典较像</p>
<p>middlewares.py：定义Downloader Middlewares(下载器中间件)和Spider Middlewares(蜘蛛中间件)的实现</p>
<p>pipelines.py:定义Item Pipeline的实现，实现数据的清洗，储存，验证。</p>
<p>settings.py：全局配置</p>
<p>3、创建一个spider（自己定义的爬虫文件）</p>
<p>例如以爬取猫眼热映口碑榜为例子来了解一下：</p>
<p>在spiders文件夹下创建一个maoyan.py文件，你也可以按住shift-右键-在此处打开命令窗口，输入：scrapy genspider 文件名 要爬取的网址。</p>
<p>自己创建的需要自己写，使用命令创建的包含最基本的东西。</p>
<p>我们来看一下使用命令创建的有什么。
<img src="https://upload-images.jianshu.io/upload_images/9489193-ae44463d0089e8f7?imageMogr2/auto-orient/strip%7CimageView2/2/w/573/format/webp" alt="null"></p>
<p>介绍一下这些是干嘛的：</p>
<p>name：是项目的名字</p>
<p>allowed_domains：是允许爬取的域名，比如一些网站有相关链接，域名就和本网站不同，这些就会忽略。</p>
<p>atart_urls：是Spider爬取的网站，定义初始的请求url，可以多个。</p>
<p>parse方法：是Spider的一个方法，在请求start_url后，之后的方法，这个方法是对网页的解析，与提取自己想要的东西。</p>
<p>response参数：是请求网页后返回的内容，也就是你需要解析的网页。</p>
<p>还有其他参数有兴趣可以去查查。</p>
<p>4、定义Item</p>
<p>item是保存爬取数据的容器，使用的方法和字典差不多。</p>
<p>我们打开items.py，之后我们想要提取的信息有：</p>
<p>index(排名)、title(电影名)、star(主演)、releasetime(上映时间)、score(评分)</p>
<p>于是我们将items.py文件修改成这样。
<img src="https://upload-images.jianshu.io/upload_images/9489193-a1274105bfabadc2?imageMogr2/auto-orient/strip%7CimageView2/2/w/758/format/webp" alt="null"></p>
<p>即可。</p>
<p>5、再次打开spider来提取我们想要的信息</p>
<p>修改成这样：
<img src="https://upload-images.jianshu.io/upload_images/9489193-928f83ef108b1852?imageMogr2/auto-orient/strip%7CimageView2/2/w/1080/format/webp" alt="null"></p>
<p>好了，一个简单的爬虫就写完了。</p>
<p>6、运行</p>
<p>在该文件夹下，按住shift-右键-在此处打开命令窗口，输入：scrapy crawl maoyan(项目的名字)</p>
<p>即可看到：
<img src="https://upload-images.jianshu.io/upload_images/9489193-3f35f7c23e305aa2?imageMogr2/auto-orient/strip%7CimageView2/2/w/1080/format/webp" alt="null"></p>
<p>7、保存</p>
<p>我们只运行了代码，看看有没有报错，并没有保存。</p>
<p>如果我们想保存为csv、xml、json格式，可以直接使用命令：</p>
<p>在该文件夹下，按住shift-右键-在此处打开命令窗口，输入：</p>
<p>scrapy crawl maoyan -o maoyan.csv</p>
<p>scrapy crawl maoyan -o maoyan.xml</p>
<p>scrapy crawl maoyan -o maoyan.json</p>
<p>选择其中一个即可。当然如果想要保存为其他格式也是可以的，这里只说常见的。这里选择json格式，运行后会发现，在文件夹下多出来一个maoyan.json的文件。打开之后发现，中文都是一串乱码，这里需要修改编码方式，当然也可以在配置里修改</p>
<p>（在settings.py文件中添加FEED_EXPORT_ENCODING=&lsquo;UTF8&rsquo;即可），</p>
<p>如果想直接在命令行中修改：</p>
<p>scrapy crawl maoyan -o maoyan.json -s FEED_EXPORT_ENCODING=UTF8</p>
<p>即可。</p>
<p>这里自己试试效果吧。</p>
<p>当然我们保存也可以在运行的时候自动保存，不需要自己写命令。后面介绍（我们还有还多文件没有用到呦）。</p>
<p>二、scrapy如何解析？</p>
<p>之前写过一篇文章：三大解析库的使用</p>
<p>但是scrapy也提供了自己的解析方式（Selector），和上面的也很相似，我们来看一下：</p>
<p>1、css</p>
<p>首先需要导入模块：from scrapy import Selector</p>
<p>例如有这样一段html代码：</p>
<p>html=&rsquo;<html><head><title>Demo</title></head><body><div class='cla'>This is Demo</div></body></html></p>
<p>1.1、首先需要构建一个Selector对象</p>
<p>sel = Selector(html)</p>
<p>text = sel.css(&rsquo;.cla::text&rsquo;).extract_first()</p>
<p>.cla表示选中上面的div节点，::text表示获取文本，这里和以前的有所不同。</p>
<p>extract_first()表示返回第一个元素，因为上述 sel.css(&rsquo;.cla::text&rsquo;)返回的是一个列表，你也可以写成sel.css(&rsquo;.cla::text&rsquo;)[0]来获取第一个元素，但是如果为空，就会报出超出最大索引的错误，不建议这样写，而使用extract_first()就不会报错，同时如果写成extract_first(&lsquo;123&rsquo;)这样，如果为空就返回123</p>
<p>1.2、有了选取第一个，就有选取所有：extract()表示选取所有，如果返回的是多个值，就可以是这样写。</p>
<p>1.3、获取属性就是sel.css(&rsquo;.cla::sttr(&lsquo;class&rsquo;)&rsquo;).extract_first()表示获取class</p>
<p>1.4、获取指定属性的文本：sel.css(&lsquo;div[class=&ldquo;cla&rdquo;]::text&rsquo;)</p>
<p>1.5、其他写法和css的写法如出一辙。</p>
<p>1.6、在scrapy中为我们提供了一个简便的写法，在上述的简单实例中，我们知道了response为请求网页的返回值。</p>
<p>我们可以直接写成：response.css()来解析，提取我们想要的信息。同样，下面要说的XPath也可以直接写成：</p>
<p>response.xpath()来解析。</p>
<p>2、Xpath</p>
<p>Xpath的使用可以看上面的文章：三大解析库的使用</p>
<p>注意：获取的还是列表，所以还是要加上extract_first()或者extract()</p>
<p>3、正则匹配(这里用response操作)</p>
<p>例如：response.css(&lsquo;a::text&rsquo;).re(&lsquo;写正则&rsquo;)</p>
<p>这里如果response.css(&lsquo;a::text&rsquo;)匹配的是多个对象，那么加上正则也是匹配符合要求的多个对象。</p>
<p>这里如果想要匹配第一个对象，可以把re()修改成re_first()即可。</p>
<p>注意：response不可以直接调用re(),response.xpath(&rsquo;.&rsquo;).re()可以相当于达到直接使用正则的效果。</p>
<p>正则的使用：万能的正则表达式</p>
<p>三、Dowmloader Middleware的使用</p>
<p>本身scrapy就提供了很多Dowmloader Middleware，但是有时候我们要修改，</p>
<p>比如修改User-Agent，使用代理ip等。</p>
<p>以修改User-Agent为例（设置代理ip大同小异）：</p>
<p>第一种方法，可以在settings.py中直接添加USER-AGENT=&lsquo;xxx&rsquo;</p>
<p>但是我们想要添加多个User-Agent，每次随机获取一个可以利用Dowmloader Middleware来设置。</p>
<p>第一步将settings中的USER-AGENT=&lsquo;xxx&rsquo;修改成USER-AGENT=[&ldquo;xxx&rdquo;,&ldquo;xxxxx&rdquo;,&ldquo;xxxxxxx&rdquo;]</p>
<p>第二步在middlewares.py中添加：
<img src="https://upload-images.jianshu.io/upload_images/9489193-5a794618db65a28f?imageMogr2/auto-orient/strip%7CimageView2/2/w/1062/format/webp" alt="null"></p>
<p>from_crawler():通过参数crawler可以拿到配置的信息，我们的User-Agent在配置文件里，所以我们需要获取到。</p>
<p>方法名不可以修改。</p>
<p>第三步在settings.py中添加：</p>
<p><img src="https://upload-images.jianshu.io/upload_images/9489193-3d5124dfd31e7602?imageMogr2/auto-orient/strip%7CimageView2/2/w/914/format/webp" alt="null">
将scrapy自带的UserAgentmiddleware的键值设置为None,</p>
<p>自定义的设置为400，这个键值越小表示优先调用的意思。</p>
<p>四、Item Pipeline的使用。</p>
<p>1、进行数据的清洗</p>
<p>在一的实例中我们把评分小于等于8.5分的score修改为（不好看！），我们认为是不好看的电影，我们将pipeline.py修改成这样：
<img src="https://upload-images.jianshu.io/upload_images/9489193-23021209da207b71?imageMogr2/auto-orient/strip%7CimageView2/2/w/678/format/webp" alt="null"></p>
<p>在setting.py中添加：
<img src="https://upload-images.jianshu.io/upload_images/9489193-0cf21c13cd24635c?imageMogr2/auto-orient/strip%7CimageView2/2/w/580/format/webp" alt="null"></p>
<p>我们执行一下：
<img src="https://upload-images.jianshu.io/upload_images/9489193-dbefa5bdb28f345c?imageMogr2/auto-orient/strip%7CimageView2/2/w/1029/format/webp" alt="null"></p>
<p>2、储存</p>
<p>2.1储存为json格式</p>
<p>我们将pipeline.py修改成这样：
<img src="https://upload-images.jianshu.io/upload_images/9489193-292fe00da4028b96?imageMogr2/auto-orient/strip%7CimageView2/2/w/860/format/webp" alt="null"></p>
<p>在setting.py中添加：
<img src="https://upload-images.jianshu.io/upload_images/9489193-f1b5f7a2ecd95f93?imageMogr2/auto-orient/strip%7CimageView2/2/w/616/format/webp" alt="null"></p>
<p>表示先执行TextPipeline方法，再执行JsonPipeline方法，先清洗，再储存。</p>
<p>2.2储存在mysql数据库</p>
<p>首先在mysql数据库中创建一个数据库maoyanreying，创建一个表maoyan。</p>
<p>我们将pipeline.py修改成这样：
<img src="https://upload-images.jianshu.io/upload_images/9489193-cc05d60fcd6dfab3?imageMogr2/auto-orient/strip%7CimageView2/2/w/1015/format/webp" alt="null"></p>
<p>在setting.py中添加：
<img src="https://upload-images.jianshu.io/upload_images/9489193-eaa620dfc9bd8198?imageMogr2/auto-orient/strip%7CimageView2/2/w/566/format/webp" alt="null"></p>
<p>即可</p>
<p>完</p>
<p>转载:<a href="https://www.jianshu.com/p/6bc5a4641629">https://www.jianshu.com/p/6bc5a4641629</a></p>

        </div>
    </div>
    </main>

    <style>
        .content {
            font-size: 1.25rem;
          }
          
          .content h1,
          .content h2,
          .content h3,
          .content h4 {
            margin: 15px 10px 5px;
          }
          
    </style>

        <footer class="main-footer footer-type-1 text-xs">
            <div id="footer-tools" class="d-flex flex-column">
                <a href="javascript:" id="go-to-up" class="btn rounded-circle go-up m-1" rel="go-top">
                    <i class="iconfont icon-to-up"></i>
                </a>
                
                <a href="javascript:" data-toggle="modal" data-target="#search-modal" class="btn rounded-circle m-1"
                    rel="search" one-link-mark="yes">
                    <i class="iconfont icon-search"></i>
                </a>
                <a href="https://www.yuque.com/shenweiyan" class="btn rounded-circle kefu m-1" target="_blank" data-toggle="tooltip" data-placement="left" title="联系我们">
                    <i class="mode-ico iconfont icon-qq"></i>
                </a>
                
                
		<a href="javascript:" onclick="window.location.href='javascript:switchNightMode()'" class="btn rounded-circle switch-dark-mode m-1" id="yejian"
                    data-toggle="tooltip" data-placement="left" title="日间模式">
                    <i class="mode-ico iconfont icon-night"></i>
                </a>
                
            </div>
            <div class="footer-inner">
                <div class="footer-text">本站内容源自互联网，如有内容侵犯了你的权益，请联系删除相关内容，联系邮箱：jackxiazhou@yeah.net <br/>© 2023 - 2024 By <a href="https://github.com/shenweiyan/WebStack-Hugo">WebStack-Hugo</a> | <a href="https://www.bioitee.com/">Bio IT 爱好者</a> | <a href="http://beian.miit.gov.cn/">京ICP备17039180号-1</a><br/></div>
            </div>
        </footer>
    </div>
</div>


<script type='text/javascript' src='/assets/js/jquery.ui.touch-punch.min-0.2.2.js' id='jqueryui-touch-js'></script>
<script type='text/javascript' src='/assets/js/clipboard.min-5.6.2.js' id='clipboard-js'></script>
<script type='text/javascript' src='/assets/js/tooltip-extend.js' id='iplaycode-nav-js'></script>
<script type='text/javascript' id='popper-js-extra'>
 

var theme = {"ajaxurl":"","addico":"https:\/\/nav.baidu.cn\/wp-content\/themes\/onenav\/images\/add.png","order":"asc","formpostion":"top","defaultclass":"io-grey-mode","isCustomize":"1","icourl":"","icopng":".png","urlformat":"1","customizemax":"10","newWindow":"0","lazyload":"1","minNav":"1","loading":"1","hotWords":"baidu","classColumns":" col-sm-6 col-md-4 col-xl-5a col-xxl-6a ","apikey":"TWpBeU1UVTNOekk1TWpVMEIvZ1M2bFVIQllUMmxsV1dZelkxQTVPVzB3UW04eldGQmxhM3BNWW14bVNtWk4="};
 
</script>
<script type='text/javascript' src='/assets/js/popper.min.js' id='popper-js'></script>
<script type='text/javascript' src='/assets/js/bootstrap.min-4.3.1.js' id='bootstrap-js'></script>
<script type='text/javascript' src='/assets/js/theia-sticky-sidebar-1.5.0.js' id='sidebar-js'></script>
<script type='text/javascript' src='/assets/js/lazyload.min-12.4.0.js' id='lazyload-js'></script>
<script type='text/javascript' src='/assets/js/fancybox.min-3.5.7.js' id='lightbox-js-js'></script>

<script type='text/javascript' src='/assets/js/app-mini.js' id='appmini-js'></script>

<script type="text/javascript">
    $(document).ready(function(){
        var siteWelcome = $('#loading');
        siteWelcome.addClass('close');
        setTimeout(function() {
            siteWelcome.remove();
        }, 600);
    });
</script>
<script>        
    $(document).ready(function(){
        setTimeout(function () {
            if ($('a.smooth[href="' + window.location.hash + '"]')[0]) {
                $('a.smooth[href="' + window.location.hash + '"]').click();
            }else if (window.location.hash != '') {
                $("html, body").animate({
                    scrollTop: $(window.location.hash).offset().top - 90
                }, {
                    duration: 500,
                    easing: "swing"
                });
            }
        }, 300);
        $(document).on('click','a.smooth',function(ev) {
            if($('#sidebar').hasClass('show') && !$(this).hasClass('change-href')){
                $('#sidebar').modal('toggle');
            }
            if($(this).attr("href").substr(0, 1) == "#"){
                $("html, body").animate({
                    scrollTop: $($(this).attr("href")).offset().top - 90
                }, {
                    duration: 500,
                    easing: "swing"
                });
            }
            if($(this).hasClass('go-search-btn')){
                $('#search-text').focus();
            }
            if(!$(this).hasClass('change-href')){
                var menu =  $("a"+$(this).attr("href"));
                menu.click();
                toTarget(menu.parent().parent(),true,true);
            }
        });
        $(document).on('click','a.tab-noajax',function(ev) {
            var url = $(this).data('link');
            if(url)
                $(this).parents('.d-flex.flex-fill.flex-tab').children('.btn-move.tab-move').show().attr('href', url);
            else
                $(this).parents('.d-flex.flex-fill.flex-tab').children('.btn-move.tab-move').hide();
        });
        
    });
</script>

<script>

(function(){
    if(document.cookie.replace(/(?:(?:^|.*;\s*)night\s*\=\s*([^;]*).*$)|^.*$/, "$1") === ''){
        if(new Date().getHours() > 22 || new Date().getHours() < 6){
            document.body.classList.remove('io-black-mode');
            document.body.classList.add('io-grey-mode');
            document.cookie = "night=1;path=/";
            console.log('夜间模式开启');
        }else{
            document.body.classList.remove('night');
            document.cookie = "night=0;path=/";
            console.log('夜间模式关闭');
        }
    }else{
        var night = document.cookie.replace(/(?:(?:^|.*;\s*)night\s*\=\s*([^;]*).*$)|^.*$/, "$1") || '0';
        if(night == '0'){
            document.body.classList.remove('night');
        }else if(night == '1'){
            document.body.classList.add('night');
        }
    }
})();

$("#search-bg").css("background-image", "url(assets\/images\/bg-dna.jpg)");   
function switchNightMode(){
    var night = document.cookie.replace(/(?:(?:^|.*;\s*)night\s*\=\s*([^;]*).*$)|^.*$/, "$1") || '0';
    if(night == '0'){
	$("#search-bg").css("background-image", "url(assets\/images\/bg-dna.jpg)");
        document.body.classList.remove('io-grey-mode');
        document.body.classList.add('io-black-mode');
        document.cookie = "night=1;path=/"
        console.log(' ');
        $(".switch-dark-mode").attr("data-original-title","日间模式");
        $(".mode-ico").removeClass("icon-night");
        $(".mode-ico").addClass("icon-light");
    }else{
	$("#search-bg").css("background-image", "url(assets\/images\/bg-dna.jpg)")
        document.body.classList.remove('io-black-mode');
        document.body.classList.add('io-grey-mode');
        document.cookie = "night=0;path=/"
        console.log(' ');
        $(".switch-dark-mode").attr("data-original-title","夜间模式");
        $(".mode-ico").removeClass("icon-light");
        $(".mode-ico").addClass("icon-night");
    }
}
</script>
</body>
</html>

